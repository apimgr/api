<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DateTime Tools - {{.SiteTitle}}</title>
    <meta name="description" content="DateTime utilities: timestamp conversion, timezone handling, date arithmetic">
    <meta name="theme-color" content="#6366f1">
    <link rel="manifest" href="/manifest.json">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/main.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <a href="/" class="nav-brand">
                <div class="nav-brand-icon">üõ†Ô∏è</div>
                <span>{{.SiteTitle}}</span>
            </a>
            <div class="nav-links">
                <a href="/" class="nav-link">Home</a>
                <a href="/text" class="nav-link">Text</a>
                <a href="/crypto" class="nav-link">Crypto</a>
                <a href="/datetime" class="nav-link active">DateTime</a>
                <a href="/api" class="nav-link">API</a>
            </div>
        </nav>
    </header>

    <main>
        <section class="search-section">
            <div class="container container-sm">
                <div class="section-header">
                    <h1 class="section-title">DateTime Tools</h1>
                    <p class="section-description">Timestamp conversion, timezone handling, and date calculations</p>
                </div>

                <!-- Current Time -->
                <div class="tool-card">
                    <h3>Current Time</h3>
                    <div class="form-group">
                        <label class="form-label">Timezone</label>
                        <select id="now-timezone" class="form-input">
                            <option value="">UTC</option>
                            <option value="America/New_York">America/New_York (EST/EDT)</option>
                            <option value="America/Chicago">America/Chicago (CST/CDT)</option>
                            <option value="America/Denver">America/Denver (MST/MDT)</option>
                            <option value="America/Los_Angeles">America/Los_Angeles (PST/PDT)</option>
                            <option value="Europe/London">Europe/London (GMT/BST)</option>
                            <option value="Europe/Paris">Europe/Paris (CET/CEST)</option>
                            <option value="Europe/Berlin">Europe/Berlin (CET/CEST)</option>
                            <option value="Asia/Tokyo">Asia/Tokyo (JST)</option>
                            <option value="Asia/Shanghai">Asia/Shanghai (CST)</option>
                            <option value="Asia/Kolkata">Asia/Kolkata (IST)</option>
                            <option value="Australia/Sydney">Australia/Sydney (AEST/AEDT)</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="getCurrentTime()">Get Current Time</button>
                    <div id="now-result" class="result-output" style="display: none;"></div>
                </div>

                <!-- Unix Timestamp Converter -->
                <div class="tool-card">
                    <h3>Unix Timestamp Converter</h3>
                    <div class="form-group">
                        <label class="form-label">Unix Timestamp</label>
                        <input type="text" id="unix-input" class="form-input" placeholder="1700000000">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Timezone</label>
                        <select id="unix-timezone" class="form-input">
                            <option value="">UTC</option>
                            <option value="America/New_York">America/New_York</option>
                            <option value="America/Los_Angeles">America/Los_Angeles</option>
                            <option value="Europe/London">Europe/London</option>
                            <option value="Europe/Paris">Europe/Paris</option>
                            <option value="Asia/Tokyo">Asia/Tokyo</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="convertFromUnix()">Convert</button>
                    <div id="unix-result" class="result-output" style="display: none;"></div>
                </div>

                <!-- Date to Unix -->
                <div class="tool-card">
                    <h3>Date to Unix Timestamp</h3>
                    <div class="form-group">
                        <label class="form-label">Date/Time String</label>
                        <input type="text" id="date-input" class="form-input" placeholder="2024-01-15T10:30:00Z or 2024-01-15">
                    </div>
                    <button class="btn btn-primary" onclick="convertToUnix()">Convert to Unix</button>
                    <div id="date-result" class="result-output" style="display: none;"></div>
                </div>

                <!-- Date Arithmetic -->
                <div class="tool-card">
                    <h3>Date Arithmetic</h3>
                    <div class="form-group">
                        <label class="form-label">Unix Timestamp (leave empty for now)</label>
                        <input type="text" id="arith-timestamp" class="form-input" placeholder="1700000000">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Duration</label>
                            <input type="text" id="arith-duration" class="form-input" placeholder="1d, 2w, 1M, 24h">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="addDuration()">Add Duration</button>
                    <div id="arith-result" class="result-output" style="display: none;"></div>
                </div>

                <!-- Time Difference -->
                <div class="tool-card">
                    <h3>Time Difference</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">From (Unix)</label>
                            <input type="text" id="diff-from" class="form-input" placeholder="1700000000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">To (Unix)</label>
                            <input type="text" id="diff-to" class="form-input" placeholder="1700086400">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="calculateDiff()">Calculate Difference</button>
                    <div id="diff-result" class="result-output" style="display: none;"></div>
                </div>

                <!-- Timezone Converter -->
                <div class="tool-card">
                    <h3>Timezone Converter</h3>
                    <div class="form-group">
                        <label class="form-label">Unix Timestamp</label>
                        <input type="text" id="tz-timestamp" class="form-input" placeholder="1700000000">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">From Timezone</label>
                            <select id="tz-from" class="form-input">
                                <option value="UTC">UTC</option>
                                <option value="America/New_York">America/New_York</option>
                                <option value="America/Los_Angeles">America/Los_Angeles</option>
                                <option value="Europe/London">Europe/London</option>
                                <option value="Asia/Tokyo">Asia/Tokyo</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">To Timezone</label>
                            <select id="tz-to" class="form-input">
                                <option value="America/New_York">America/New_York</option>
                                <option value="America/Los_Angeles">America/Los_Angeles</option>
                                <option value="Europe/London">Europe/London</option>
                                <option value="Europe/Paris">Europe/Paris</option>
                                <option value="Asia/Tokyo">Asia/Tokyo</option>
                                <option value="UTC">UTC</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="convertTimezone()">Convert</button>
                    <div id="tz-result" class="result-output" style="display: none;"></div>
                </div>

                <!-- All Timezones -->
                <div class="tool-card">
                    <h3>World Clocks</h3>
                    <button class="btn btn-primary" onclick="loadTimezones()">Show World Clocks</button>
                    <div id="tz-list" class="result-output" style="display: none;"></div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-brand">
                <div class="footer-logo">üõ†Ô∏è</div>
                <span class="footer-text">{{.SiteTitle}} - Part of apimgr</span>
            </div>
            <div class="footer-links">
                <a href="/api" class="footer-link">API Docs</a>
                <a href="/healthz" class="footer-link">Status</a>
                <a href="https://github.com/apimgr" class="footer-link">GitHub</a>
            </div>
        </div>
    </footer>

    <script src="/static/js/main.js"></script>
    <script>
        async function getCurrentTime() {
            const timezone = document.getElementById('now-timezone').value;
            const result = document.getElementById('now-result');

            let url = '/api/v1/datetime/now';
            if (timezone) url += `?timezone=${encodeURIComponent(timezone)}`;

            const response = await fetch(url);
            const data = await response.json();

            result.style.display = 'block';
            if (data.error) {
                result.innerHTML = `<span class="error">${data.error}</span>`;
            } else {
                result.innerHTML = `
                    <div class="time-display">${data.human}</div>
                    <div class="time-grid">
                        <div><strong>Unix:</strong> <code>${data.unix}</code></div>
                        <div><strong>ISO 8601:</strong> <code>${data.iso8601}</code></div>
                        <div><strong>RFC 2822:</strong> <code>${data.rfc2822}</code></div>
                        <div><strong>Date:</strong> ${data.date}</div>
                        <div><strong>Time:</strong> ${data.time}</div>
                        <div><strong>Timezone:</strong> ${data.timezone} (${data.offset})</div>
                        <div><strong>Day:</strong> ${data.day_of_week_name} (#${data.day_of_year})</div>
                        <div><strong>Week:</strong> ${data.week_number} | Q${data.quarter}</div>
                        <div><strong>Leap Year:</strong> ${data.is_leap_year ? 'Yes' : 'No'}</div>
                    </div>
                `;
            }
        }

        async function convertFromUnix() {
            const timestamp = document.getElementById('unix-input').value;
            const timezone = document.getElementById('unix-timezone').value;
            const result = document.getElementById('unix-result');

            if (!timestamp) {
                result.style.display = 'block';
                result.innerHTML = '<span class="error">Please enter a timestamp</span>';
                return;
            }

            let url = `/api/v1/datetime/from/${timestamp}`;
            if (timezone) url += `?timezone=${encodeURIComponent(timezone)}`;

            const response = await fetch(url);
            const data = await response.json();

            result.style.display = 'block';
            if (data.error) {
                result.innerHTML = `<span class="error">${data.error}</span>`;
            } else {
                result.innerHTML = `
                    <div class="time-display">${data.human}</div>
                    <div class="time-grid">
                        <div><strong>ISO 8601:</strong> <code>${data.iso8601}</code></div>
                        <div><strong>RFC 2822:</strong> <code>${data.rfc2822}</code></div>
                        <div><strong>Date:</strong> ${data.date}</div>
                        <div><strong>Time:</strong> ${data.time}</div>
                        <div><strong>Timezone:</strong> ${data.timezone} (${data.offset})</div>
                    </div>
                `;
            }
        }

        async function convertToUnix() {
            const datetime = document.getElementById('date-input').value;
            const result = document.getElementById('date-result');

            if (!datetime) {
                result.style.display = 'block';
                result.innerHTML = '<span class="error">Please enter a date/time string</span>';
                return;
            }

            const response = await fetch(`/api/v1/datetime/to/${encodeURIComponent(datetime)}`);
            const data = await response.json();

            result.style.display = 'block';
            if (data.error) {
                result.innerHTML = `<span class="error">${data.error}</span>`;
            } else {
                result.innerHTML = `
                    <div><strong>Unix Timestamp:</strong> <code>${data.unix}</code></div>
                    <div><strong>Unix (ms):</strong> <code>${data.unix * 1000}</code></div>
                `;
            }
        }

        async function addDuration() {
            let timestamp = document.getElementById('arith-timestamp').value;
            const duration = document.getElementById('arith-duration').value;
            const result = document.getElementById('arith-result');

            if (!timestamp) {
                timestamp = Math.floor(Date.now() / 1000);
            }

            if (!duration) {
                result.style.display = 'block';
                result.innerHTML = '<span class="error">Please enter a duration</span>';
                return;
            }

            const response = await fetch(`/api/v1/datetime/add/${timestamp}/${encodeURIComponent(duration)}`);
            const data = await response.json();

            result.style.display = 'block';
            if (data.error) {
                result.innerHTML = `<span class="error">${data.error}</span>`;
            } else {
                result.innerHTML = `
                    <div><strong>Original:</strong> ${data.original}</div>
                    <div><strong>Duration:</strong> ${data.duration}</div>
                    <div><strong>Result:</strong> ${data.result}</div>
                    <div><strong>Unix:</strong> <code>${data.result_unix}</code></div>
                `;
            }
        }

        async function calculateDiff() {
            const from = document.getElementById('diff-from').value;
            const to = document.getElementById('diff-to').value;
            const result = document.getElementById('diff-result');

            if (!from || !to) {
                result.style.display = 'block';
                result.innerHTML = '<span class="error">Please enter both timestamps</span>';
                return;
            }

            const response = await fetch(`/api/v1/datetime/diff/${from}/${to}`);
            const data = await response.json();

            result.style.display = 'block';
            result.innerHTML = `
                <div class="time-display">${data.human}</div>
                <div class="time-grid">
                    <div><strong>From:</strong> ${data.from}</div>
                    <div><strong>To:</strong> ${data.to}</div>
                    <div><strong>Days:</strong> ${data.days}</div>
                    <div><strong>Hours:</strong> ${data.hours}</div>
                    <div><strong>Minutes:</strong> ${data.minutes}</div>
                    <div><strong>Seconds:</strong> ${data.seconds}</div>
                    <div><strong>Milliseconds:</strong> ${data.milliseconds}</div>
                </div>
            `;
        }

        async function convertTimezone() {
            const timestamp = document.getElementById('tz-timestamp').value;
            const from = document.getElementById('tz-from').value;
            const to = document.getElementById('tz-to').value;
            const result = document.getElementById('tz-result');

            if (!timestamp) {
                result.style.display = 'block';
                result.innerHTML = '<span class="error">Please enter a timestamp</span>';
                return;
            }

            const response = await fetch(`/api/v1/datetime/convert/${timestamp}/${encodeURIComponent(from)}/${encodeURIComponent(to)}`);
            const data = await response.json();

            result.style.display = 'block';
            if (data.error) {
                result.innerHTML = `<span class="error">${data.error}</span>`;
            } else {
                result.innerHTML = `
                    <div><strong>Unix:</strong> <code>${data.unix}</code></div>
                    <div><strong>${data.from_zone}:</strong> ${data.from}</div>
                    <div><strong>${data.to_zone}:</strong> ${data.to}</div>
                `;
            }
        }

        async function loadTimezones() {
            const result = document.getElementById('tz-list');

            const response = await fetch('/api/v1/datetime/timezones');
            const data = await response.json();

            result.style.display = 'block';
            result.innerHTML = `
                <div class="tz-grid">
                    ${data.timezones.map(tz => `
                        <div class="tz-item">
                            <div class="tz-name">${tz.name}</div>
                            <div class="tz-time">${tz.current_time}</div>
                            <div class="tz-offset">${tz.abbreviation} (${tz.offset})</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Load current time on page load
        document.addEventListener('DOMContentLoaded', getCurrentTime);
    </script>

    <style>
        .tool-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            margin-bottom: var(--space-4);
        }

        .tool-card h3 {
            margin-bottom: var(--space-4);
            font-size: 1.125rem;
        }

        .result-output {
            margin-top: var(--space-4);
            padding: var(--space-4);
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
        }

        .result-output code {
            color: var(--primary);
        }

        .result-output .error {
            color: #ef4444;
        }

        .time-display {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: var(--space-3);
            color: var(--text-primary);
        }

        .time-grid {
            display: grid;
            gap: var(--space-2);
        }

        .time-grid > div {
            padding: var(--space-1) 0;
            border-bottom: 1px solid var(--border-primary);
        }

        .time-grid > div:last-child {
            border-bottom: none;
        }

        .tz-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: var(--space-3);
        }

        .tz-item {
            padding: var(--space-3);
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            text-align: center;
        }

        .tz-name {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            margin-bottom: var(--space-1);
        }

        .tz-time {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
        }

        .tz-offset {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: var(--space-1);
        }
    </style>
</body>
</html>
